---
title: "Nucleotaide_diversity"
author: "Nicolas Zapata"
date: "2025-09-23"
output: html_document
---



```{r setup, include=FALSE}

knitr::opts_chunk$set(echo = TRUE)

knitr::opts_knit$set(root.dir = '~/projects/eco_genomics_2025/population_genomics/myresults/ANGSD/diversity/')

```
 
Import our libraries for plotting
 
 
```{r}
library(ggplot2)

library(tidyverse)

```
 
 
Read in our theta outputs 

```{r}

theta <-read.table('2030_ALL_win50000_step50000.thetas',header=T, sep='\t')
 
head(theta)
 
 
```
 
First we need to scale our theta by n sites
 
```{r}

theta$tWsite = theta$tW/theta$nSites   #scaling watersons theta by nsites

theta$tPsite = theta$tP/theta$nSites
 
 
```
 
```{r}

summary(theta)
 
theta2<-theta %>% 

  arrange(Chr, WinCenter) %>% 

  filter(nSites>100) 

summary(theta2)

```

```{r}
ggplot (theta2, aes(nSites)) +
   geom_histogram(bin=50, fill = "Lightblue" ) +
   geom_vline(xintercept+)

```


Let's plot nucleotide diversity as Pi
```{r}
ggplot(theta2, aes(x=Chr, y=tPsite, color=Chr)) +
  geom_point(size=0.75, shape=1, show.legent=F) +
  ylim(0,0.07) +
  labs(title="Nucleotide diversity in 50 kb windiws for population 2030", x="Scaffold", y="Theta")
